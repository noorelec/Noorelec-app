<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Firebase DevTech V2</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #6366f1; }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .success { background: #d1fae5; color: #065f46; }
        .error { background: #fee2e2; color: #991b1b; }
        .info { background: #dbeafe; color: #1e40af; }
        button {
            background: #6366f1;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #4f46e5; }
        .log {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .log div { margin: 5px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Firebase - DevTech V1.1</h1>
        
        <div id="initStatus" class="status info">‚è≥ Initialisation en cours...</div>
        
        <div>
            <button onclick="testSignup()">üîê Tester l'inscription</button>
            <button onclick="clearLogs()">üóëÔ∏è Effacer les logs</button>
        </div>
        
        <div id="testResult"></div>
        
        <h3>üìã Console de logs :</h3>
        <div id="logs" class="log"></div>
    </div>

    <script type="module">
        // Fonction de logging
        function log(message, type = 'info') {
            const logsDiv = document.getElementById('logs');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ef4444' : type === 'success' ? '#10b981' : '#60a5fa';
            logsDiv.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logsDiv.scrollTop = logsDiv.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        window.clearLogs = function() {
            document.getElementById('logs').innerHTML = '';
            log('Logs effac√©s', 'info');
        }

        // Import Firebase
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';

        log('üîÑ D√©marrage du test Firebase...', 'info');

        const firebaseConfig = {
            apiKey: "AIzaSyD2v9knFsWsOAe_eWudFVWoojylojQFgSU",
            authDomain: "devtech-20997.firebaseapp.com",
            projectId: "devtech-20997",
            storageBucket: "devtech-20997.firebasestorage.app",
            messagingSenderId: "95961701207",
            appId: "1:95961701207:web:34659317465bedf897bc12",
            measurementId: "G-D9VZ140KSF"
        };

        log('üìù Configuration Firebase charg√©e', 'info');
        log(`   - Project ID: ${firebaseConfig.projectId}`, 'info');
        log(`   - Auth Domain: ${firebaseConfig.authDomain}`, 'info');
        log(`   - API Key: ${firebaseConfig.apiKey.substring(0, 20)}...`, 'info');

        // Initialiser Firebase
        let app, auth;
        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            
            log('‚úÖ Firebase initialis√© avec succ√®s!', 'success');
            document.getElementById('initStatus').className = 'status success';
            document.getElementById('initStatus').innerHTML = '‚úÖ Firebase initialis√© avec succ√®s!';
            
            log(`   - Auth configur√©: ${auth.name}`, 'success');
            log(`   - Current User: ${auth.currentUser ? auth.currentUser.email : 'Aucun'}`, 'info');
            
        } catch (error) {
            log('‚ùå Erreur d\'initialisation Firebase', 'error');
            log(`   - Code: ${error.code}`, 'error');
            log(`   - Message: ${error.message}`, 'error');
            
            document.getElementById('initStatus').className = 'status error';
            document.getElementById('initStatus').innerHTML = '‚ùå Erreur: ' + error.message;
        }

        // Fonction de test d'inscription
        window.testSignup = async function() {
            const resultDiv = document.getElementById('testResult');
            resultDiv.innerHTML = '<div class="status info">‚è≥ Test d\'inscription en cours...</div>';
            
            const testEmail = 'test-' + Date.now() + '@devtech.be';
            const testPassword = 'TestDevTech123!';
            
            log('üöÄ D√©but du test d\'inscription', 'info');
            log(`   - Email: ${testEmail}`, 'info');
            log(`   - Password: ${testPassword.replace(/./g, '*')}`, 'info');
            
            try {
                log('üì° Envoi de la requ√™te √† Firebase...', 'info');
                const userCredential = await createUserWithEmailAndPassword(auth, testEmail, testPassword);
                
                log('‚úÖ Inscription r√©ussie!', 'success');
                log(`   - UID: ${userCredential.user.uid}`, 'success');
                log(`   - Email: ${userCredential.user.email}`, 'success');
                log(`   - Created: ${new Date(userCredential.user.metadata.creationTime).toLocaleString()}`, 'success');
                
                resultDiv.innerHTML = `
                    <div class="status success">
                        ‚úÖ Test r√©ussi! Utilisateur cr√©√©:<br>
                        - Email: ${userCredential.user.email}<br>
                        - UID: ${userCredential.user.uid}
                    </div>
                `;
                
            } catch (error) {
                log('‚ùå Erreur lors de l\'inscription', 'error');
                log(`   - Code: ${error.code}`, 'error');
                log(`   - Message: ${error.message}`, 'error');
                
                if (error.customData) {
                    log(`   - Custom Data: ${JSON.stringify(error.customData)}`, 'error');
                }
                
                resultDiv.innerHTML = `
                    <div class="status error">
                        ‚ùå Erreur: ${error.code}<br>
                        ${error.message}
                    </div>
                `;
                
                // Suggestions bas√©es sur le code d'erreur
                if (error.code === 'auth/api-key-not-valid.-Please-pass-a-valid-API-key.') {
                    log('üí° Solution: V√©rifier les restrictions de domaine dans Google Cloud Console', 'info');
                } else if (error.code === 'auth/email-already-in-use') {
                    log('üí° Info: Cet email existe d√©j√† (normal en test)', 'info');
                }
            }
        }

        log('üéØ Pr√™t pour les tests!', 'success');
    </script>
</body>
</html>
